<% content_for(:body_attributes) do %>
  data-turbolinks="false"
<% end %>

<h1 class="govuk-heading-xl govuk-!-margin-bottom-3 ">Allocations</h1>

<%= render '/shared/search' %>
<%= render(:partial => 'tabs_start', :locals => {:active => :allocated, :search_term => @q }) %>

<section class="govuk-tabs__panel" id="allocated">
  <table class="govuk-table responsive tablesorter">
    <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th class="govuk-table__header" scope="col"><a
        class='table-sorter__link' href='#'>Prisoner name</a></th>
      <th class="govuk-table__header sorter-false" scope="col">Prisoner number</th>
      <th class="govuk-table__header sorter-false" scope="col">Release/parole<br/>eligibility</th>
      <th class="govuk-table__header" scope="col"><a
        class='table-sorter__link' href='#'>POM</a></th>
      <th class="govuk-table__header" scope="col"><a
        class='table-sorter__link' href='#'>Allocation date</a></th>
      <th class="govuk-table__header sorter-false" scope="col">Action</th>
    </tr>
    </thead>
    <tbody class="govuk-table__body">
    <% @summary.offenders.each_with_index do |offender, i| %>
      <tr class="govuk-table__row allocated_offender_row_<%= i %>">
        <td aria-label="Prisoner name" class="govuk-table__cell"><%= offender.full_name %></td>
        <td aria-label="Prisoner number" class="govuk-table__cell"><%= offender.offender_no %></td>
        <td aria-label="Release date" class="govuk-table__cell"><%= format_date(offender.release_date) %></td>
        <td aria-label="POM" class="govuk-table__cell"><%= offender.allocated_pom_name %></td>
        <td aria-label="Allocation date" class="govuk-table__cell"><%= format_date(offender.allocation_date) %></td>
        <td aria-label="Action" class="govuk-table__cell "><%= link_to "Reallocate", edit_allocations_path(offender.offender_no) %></td>
      </tr>
    <% end %>
    </tbody>
  </table>

  <%= render(
          :partial => 'shared/pagination',
          :locals => {
              :page_data => @page_meta,
              :param_name => 'page',
          }) %>

</section>

<%= render 'tabs_end' %>